<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Screen Time Rewards - Harper & Finley</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚è∞</text></svg>">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
    input:focus { outline: none; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Task definitions with minute values
    const TASKS = {
      chores: [
        { id: 'clean-room', name: 'Clean Room', minutes: 15, emoji: 'üõèÔ∏è' },
        { id: 'dishes', name: 'Do Dishes', minutes: 10, emoji: 'üçΩÔ∏è' },
        { id: 'laundry', name: 'Help with Laundry', minutes: 10, emoji: 'üëï' },
        { id: 'vacuum', name: 'Vacuum', minutes: 15, emoji: 'üßπ' },
        { id: 'pet-care', name: 'Feed/Care for Pets', minutes: 10, emoji: 'üêæ' },
        { id: 'tidy-up', name: 'Tidy Living Room', minutes: 10, emoji: 'üõãÔ∏è' },
        { id: 'make-bed', name: 'Make Bed', minutes: 5, emoji: 'üõèÔ∏è' },
        { id: 'take-trash', name: 'Take Out Trash', minutes: 5, emoji: 'üóëÔ∏è' },
      ],
      homework: [
        { id: 'homework', name: 'Finish Homework', minutes: 20, emoji: 'üìö' },
        { id: 'reading-15', name: '15 Min Reading', minutes: 10, emoji: 'üìñ' },
        { id: 'reading-30', name: '30 Min Reading', minutes: 20, emoji: 'üìñ' },
        { id: 'practice-instrument', name: 'Practice Instrument', minutes: 15, emoji: 'üéµ' },
        { id: 'math-practice', name: 'Extra Math Practice', minutes: 15, emoji: 'üî¢' },
        { id: 'spelling', name: 'Spelling Practice', minutes: 10, emoji: '‚úèÔ∏è' },
      ],
      behavior: [
        { id: 'helped-sibling', name: 'Helped Sister', minutes: 10, emoji: 'üíï' },
        { id: 'followed-directions', name: 'Followed Directions Well', minutes: 10, emoji: '‚≠ê' },
        { id: 'kind-words', name: 'Used Kind Words', minutes: 5, emoji: 'üí¨' },
        { id: 'no-complaints', name: 'No Complaints Today', minutes: 15, emoji: 'üòä' },
        { id: 'extra-helpful', name: 'Extra Helpful', minutes: 10, emoji: 'üåü' },
        { id: 'good-manners', name: 'Good Manners', minutes: 5, emoji: 'üôè' },
      ],
    };

    const CHILDREN = [
      { id: 'harper', name: 'Harper', color: '#8B5CF6', bgColor: '#EDE9FE', emoji: 'üíú' },
      { id: 'finley', name: 'Finley', color: '#EC4899', bgColor: '#FCE7F3', emoji: 'üíñ' },
    ];

    const PARENT_PIN = '1234'; // Default PIN - parents can change this

    // Local storage helpers
    const loadFromStorage = (key, defaultValue) => {
      try {
        const saved = localStorage.getItem(key);
        return saved ? JSON.parse(saved) : defaultValue;
      } catch { return defaultValue; }
    };

    const saveToStorage = (key, value) => {
      try { localStorage.setItem(key, JSON.stringify(value)); } catch {}
    };

    function App() {
      // User mode: null (login screen), 'parent', 'harper', 'finley'
      const [userMode, setUserMode] = useState(null);
      const [pinInput, setPinInput] = useState('');
      const [pinError, setPinError] = useState(false);
      const [parentPin, setParentPin] = useState(() => loadFromStorage('parent_pin', PARENT_PIN));

      // App state
      const [balances, setBalances] = useState(() => loadFromStorage('screentime_balances', { harper: 0, finley: 0 }));
      const [history, setHistory] = useState(() => {
        const saved = loadFromStorage('screentime_history', []);
        return saved.map(h => ({ ...h, timestamp: new Date(h.timestamp) }));
      });
      const [taskSubmissions, setTaskSubmissions] = useState(() => {
        const saved = loadFromStorage('screentime_submissions', []);
        return saved.map(s => ({ ...s, timestamp: new Date(s.timestamp) }));
      });
      const [screenTimeRequests, setScreenTimeRequests] = useState(() => {
        const saved = loadFromStorage('screentime_requests', []);
        return saved.map(r => ({ ...r, timestamp: new Date(r.timestamp) }));
      });

      // UI state
      const [activeTab, setActiveTab] = useState('dashboard');
      const [showTaskModal, setShowTaskModal] = useState(false);
      const [showRequestModal, setShowRequestModal] = useState(false);
      const [selectedTask, setSelectedTask] = useState(null);
      const [proofText, setProofText] = useState('');
      const [requestMinutes, setRequestMinutes] = useState(30);
      const [requestActivity, setRequestActivity] = useState('');
      const [showChangePinModal, setShowChangePinModal] = useState(false);
      const [newPin, setNewPin] = useState('');

      // Save to localStorage when data changes
      useEffect(() => { saveToStorage('screentime_balances', balances); }, [balances]);
      useEffect(() => { saveToStorage('screentime_history', history); }, [history]);
      useEffect(() => { saveToStorage('screentime_submissions', taskSubmissions); }, [taskSubmissions]);
      useEffect(() => { saveToStorage('screentime_requests', screenTimeRequests); }, [screenTimeRequests]);
      useEffect(() => { saveToStorage('parent_pin', parentPin); }, [parentPin]);

      const currentChild = CHILDREN.find(c => c.id === userMode);
      const pendingSubmissions = taskSubmissions.filter(s => s.status === 'pending');
      const pendingRequests = screenTimeRequests.filter(r => r.status === 'pending');
      const myPendingSubmissions = taskSubmissions.filter(s => s.childId === userMode && s.status === 'pending');
      const myPendingRequests = screenTimeRequests.filter(r => r.childId === userMode && r.status === 'pending');

      // Login handlers
      const handleParentLogin = () => {
        if (pinInput === parentPin) {
          setUserMode('parent');
          setPinInput('');
          setPinError(false);
        } else {
          setPinError(true);
          setPinInput('');
        }
      };

      const handleChildLogin = (childId) => {
        setUserMode(childId);
      };

      const handleLogout = () => {
        setUserMode(null);
        setActiveTab('dashboard');
        setPinInput('');
        setPinError(false);
      };

      const handleChangePin = () => {
        if (newPin.length === 4 && /^\d+$/.test(newPin)) {
          setParentPin(newPin);
          setNewPin('');
          setShowChangePinModal(false);
        }
      };

      // Child: Submit task for approval
      const submitTaskForApproval = () => {
        if (!selectedTask || !proofText.trim()) return;
        setTaskSubmissions(prev => [{
          id: Date.now(),
          childId: userMode,
          childName: currentChild.name,
          taskId: selectedTask.id,
          taskName: selectedTask.name,
          taskEmoji: selectedTask.emoji,
          minutes: selectedTask.minutes,
          proof: proofText.trim(),
          status: 'pending',
          timestamp: new Date()
        }, ...prev]);
        setShowTaskModal(false);
        setSelectedTask(null);
        setProofText('');
      };

      // Child: Submit screen time request
      const submitScreenTimeRequest = () => {
        if (!requestActivity || requestMinutes <= 0) return;
        if (requestMinutes > balances[userMode]) {
          alert("You don't have enough minutes!");
          return;
        }
        setScreenTimeRequests(prev => [{
          id: Date.now(),
          childId: userMode,
          childName: currentChild.name,
          minutes: requestMinutes,
          activity: requestActivity,
          status: 'pending',
          timestamp: new Date()
        }, ...prev]);
        setShowRequestModal(false);
        setRequestMinutes(30);
        setRequestActivity('');
      };

      // Parent: Handle task submission
      const handleTaskSubmission = (submissionId, approved) => {
        const submission = taskSubmissions.find(s => s.id === submissionId);
        if (approved && submission) {
          setBalances(prev => ({
            ...prev,
            [submission.childId]: prev[submission.childId] + submission.minutes
          }));
          setHistory(prev => [{
            id: Date.now(),
            childId: submission.childId,
            type: 'earned',
            description: submission.taskName,
            minutes: submission.minutes,
            emoji: submission.taskEmoji,
            timestamp: new Date()
          }, ...prev]);
        }
        setTaskSubmissions(prev => prev.map(s =>
          s.id === submissionId ? { ...s, status: approved ? 'approved' : 'denied' } : s
        ));
      };

      // Parent: Handle screen time request
      const handleScreenTimeRequest = (requestId, approved) => {
        const request = screenTimeRequests.find(r => r.id === requestId);
        if (approved && request) {
          setBalances(prev => ({
            ...prev,
            [request.childId]: prev[request.childId] - request.minutes
          }));
          setHistory(prev => [{
            id: Date.now(),
            childId: request.childId,
            type: 'spent',
            description: request.activity,
            minutes: -request.minutes,
            emoji: 'üì±',
            timestamp: new Date()
          }, ...prev]);
        }
        setScreenTimeRequests(prev => prev.map(r =>
          r.id === requestId ? { ...r, status: approved ? 'approved' : 'denied' } : r
        ));
      };

      // Parent: Quick add minutes (bypass approval)
      const quickAddMinutes = (childId, task) => {
        setBalances(prev => ({ ...prev, [childId]: prev[childId] + task.minutes }));
        setHistory(prev => [{
          id: Date.now(),
          childId,
          type: 'earned',
          description: task.name + ' (added by parent)',
          minutes: task.minutes,
          emoji: task.emoji,
          timestamp: new Date()
        }, ...prev]);
      };

      const formatTime = (minutes) => {
        if (minutes < 60) return `${minutes} min`;
        const hours = Math.floor(minutes / 60);
        const mins = minutes % 60;
        return mins > 0 ? `${hours}h ${mins}m` : `${hours}h`;
      };

      // Login Screen
      if (!userMode) {
        return (
          <div style={{ minHeight: '100vh', backgroundColor: '#F0F9FF', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', padding: '20px' }}>
            <div style={{ textAlign: 'center', marginBottom: '40px' }}>
              <div style={{ fontSize: '64px', marginBottom: '16px' }}>‚è∞</div>
              <h1 style={{ fontSize: '28px', color: '#1F2937', marginBottom: '8px' }}>Screen Time Rewards</h1>
              <p style={{ color: '#6B7280' }}>Who's using the app?</p>
            </div>

            {/* Child Profiles */}
            <div style={{ display: 'flex', gap: '20px', marginBottom: '40px', flexWrap: 'wrap', justifyContent: 'center' }}>
              {CHILDREN.map(child => (
                <button
                  key={child.id}
                  onClick={() => handleChildLogin(child.id)}
                  style={{
                    width: '140px',
                    padding: '24px 16px',
                    backgroundColor: 'white',
                    border: `3px solid ${child.bgColor}`,
                    borderRadius: '20px',
                    cursor: 'pointer',
                    transition: 'all 0.2s',
                    boxShadow: '0 4px 15px rgba(0,0,0,0.08)'
                  }}
                >
                  <div style={{ fontSize: '48px', marginBottom: '12px' }}>{child.emoji}</div>
                  <div style={{ fontSize: '18px', fontWeight: '600', color: child.color }}>{child.name}</div>
                  <div style={{ fontSize: '13px', color: '#6B7280', marginTop: '4px' }}>{formatTime(balances[child.id])}</div>
                </button>
              ))}
            </div>

            {/* Parent Login */}
            <div style={{ backgroundColor: 'white', borderRadius: '16px', padding: '24px', width: '100%', maxWidth: '300px', boxShadow: '0 4px 15px rgba(0,0,0,0.08)' }}>
              <h3 style={{ textAlign: 'center', marginBottom: '16px', color: '#374151' }}>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Parent Mode</h3>
              <div style={{ display: 'flex', gap: '8px' }}>
                <input
                  type="password"
                  inputMode="numeric"
                  pattern="[0-9]*"
                  maxLength={4}
                  placeholder="Enter PIN"
                  value={pinInput}
                  onChange={(e) => { setPinInput(e.target.value.replace(/\D/g, '')); setPinError(false); }}
                  onKeyDown={(e) => e.key === 'Enter' && handleParentLogin()}
                  style={{
                    flex: 1,
                    padding: '12px 16px',
                    fontSize: '18px',
                    textAlign: 'center',
                    letterSpacing: '8px',
                    border: `2px solid ${pinError ? '#EF4444' : '#E5E7EB'}`,
                    borderRadius: '10px',
                    backgroundColor: pinError ? '#FEF2F2' : 'white'
                  }}
                />
                <button
                  onClick={handleParentLogin}
                  style={{
                    padding: '12px 20px',
                    backgroundColor: '#4F46E5',
                    color: 'white',
                    border: 'none',
                    borderRadius: '10px',
                    fontWeight: '600',
                    cursor: 'pointer'
                  }}
                >
                  ‚Üí
                </button>
              </div>
              {pinError && <p style={{ color: '#EF4444', fontSize: '13px', textAlign: 'center', marginTop: '8px' }}>Wrong PIN, try again</p>}
              <p style={{ color: '#9CA3AF', fontSize: '12px', textAlign: 'center', marginTop: '12px' }}>Default PIN: 1234</p>
            </div>
          </div>
        );
      }

      // Child View
      if (userMode === 'harper' || userMode === 'finley') {
        return (
          <div style={{ minHeight: '100vh', backgroundColor: '#F0F9FF', fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif' }}>
            {/* Header */}
            <div style={{ background: `linear-gradient(135deg, ${currentChild.color} 0%, ${currentChild.color}CC 100%)`, padding: '20px', color: 'white' }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', maxWidth: '600px', margin: '0 auto' }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                  <div style={{ fontSize: '32px' }}>{currentChild.emoji}</div>
                  <div>
                    <h1 style={{ margin: 0, fontSize: '24px' }}>{currentChild.name}'s Dashboard</h1>
                    <p style={{ margin: 0, opacity: 0.9, fontSize: '14px' }}>{formatTime(balances[userMode])} available</p>
                  </div>
                </div>
                <button onClick={handleLogout} style={{ padding: '8px 16px', backgroundColor: 'rgba(255,255,255,0.2)', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer', fontSize: '14px' }}>
                  Switch User
                </button>
              </div>
            </div>

            {/* Balance Card */}
            <div style={{ padding: '20px', maxWidth: '600px', margin: '0 auto' }}>
              <div style={{ backgroundColor: 'white', borderRadius: '20px', padding: '24px', marginBottom: '20px', textAlign: 'center', boxShadow: '0 4px 15px rgba(0,0,0,0.08)' }}>
                <div style={{ fontSize: '48px', fontWeight: '700', color: currentChild.color }}>{formatTime(balances[userMode])}</div>
                <p style={{ color: '#6B7280', marginTop: '4px' }}>Screen Time Balance</p>
                <div style={{ height: '12px', backgroundColor: '#F3F4F6', borderRadius: '6px', overflow: 'hidden', marginTop: '16px' }}>
                  <div style={{ height: '100%', width: `${Math.min((balances[userMode] / 120) * 100, 100)}%`, backgroundColor: currentChild.color, borderRadius: '6px', transition: 'width 0.5s ease' }} />
                </div>
              </div>

              {/* Action Buttons */}
              <div style={{ display: 'flex', gap: '12px', marginBottom: '24px' }}>
                <button
                  onClick={() => setShowTaskModal(true)}
                  style={{ flex: 1, padding: '16px', backgroundColor: currentChild.color, color: 'white', border: 'none', borderRadius: '12px', fontWeight: '600', fontSize: '16px', cursor: 'pointer' }}
                >
                  ‚ú® I Did Something!
                </button>
                <button
                  onClick={() => setShowRequestModal(true)}
                  style={{ flex: 1, padding: '16px', backgroundColor: 'white', color: currentChild.color, border: `2px solid ${currentChild.color}`, borderRadius: '12px', fontWeight: '600', fontSize: '16px', cursor: 'pointer' }}
                >
                  üì± Use Time
                </button>
              </div>

              {/* Pending Items */}
              {(myPendingSubmissions.length > 0 || myPendingRequests.length > 0) && (
                <div style={{ backgroundColor: '#FEF3C7', borderRadius: '16px', padding: '16px', marginBottom: '20px' }}>
                  <h3 style={{ margin: '0 0 12px', color: '#92400E', fontSize: '16px' }}>‚è≥ Waiting for Parent Approval</h3>
                  {myPendingSubmissions.map(s => (
                    <div key={s.id} style={{ backgroundColor: 'white', borderRadius: '10px', padding: '12px', marginBottom: '8px', display: 'flex', alignItems: 'center', gap: '10px' }}>
                      <span style={{ fontSize: '20px' }}>{s.taskEmoji}</span>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontWeight: '500' }}>{s.taskName}</div>
                        <div style={{ fontSize: '12px', color: '#6B7280' }}>+{s.minutes} min</div>
                      </div>
                      <span style={{ backgroundColor: '#FEF3C7', color: '#92400E', padding: '4px 8px', borderRadius: '6px', fontSize: '12px', fontWeight: '500' }}>Pending</span>
                    </div>
                  ))}
                  {myPendingRequests.map(r => (
                    <div key={r.id} style={{ backgroundColor: 'white', borderRadius: '10px', padding: '12px', marginBottom: '8px', display: 'flex', alignItems: 'center', gap: '10px' }}>
                      <span style={{ fontSize: '20px' }}>üì±</span>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontWeight: '500' }}>{r.minutes} min for {r.activity}</div>
                        <div style={{ fontSize: '12px', color: '#6B7280' }}>Screen time request</div>
                      </div>
                      <span style={{ backgroundColor: '#FEF3C7', color: '#92400E', padding: '4px 8px', borderRadius: '6px', fontSize: '12px', fontWeight: '500' }}>Pending</span>
                    </div>
                  ))}
                </div>
              )}

              {/* Recent Activity */}
              <div style={{ backgroundColor: 'white', borderRadius: '16px', padding: '16px', boxShadow: '0 4px 15px rgba(0,0,0,0.08)' }}>
                <h3 style={{ margin: '0 0 12px', color: '#374151', fontSize: '16px' }}>üìú Recent Activity</h3>
                {history.filter(h => h.childId === userMode).slice(0, 5).length === 0 ? (
                  <p style={{ color: '#9CA3AF', textAlign: 'center', padding: '20px' }}>No activity yet. Complete a task to earn minutes!</p>
                ) : (
                  history.filter(h => h.childId === userMode).slice(0, 5).map(entry => (
                    <div key={entry.id} style={{ display: 'flex', alignItems: 'center', padding: '10px 0', borderBottom: '1px solid #F3F4F6' }}>
                      <div style={{ width: '32px', height: '32px', borderRadius: '50%', backgroundColor: entry.type === 'earned' ? '#D1FAE5' : '#FEE2E2', display: 'flex', alignItems: 'center', justifyContent: 'center', marginRight: '12px' }}>{entry.emoji}</div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontWeight: '500', fontSize: '14px' }}>{entry.description}</div>
                        <div style={{ fontSize: '12px', color: '#9CA3AF' }}>{new Date(entry.timestamp).toLocaleDateString()}</div>
                      </div>
                      <div style={{ fontWeight: '600', color: entry.type === 'earned' ? '#059669' : '#DC2626' }}>{entry.type === 'earned' ? '+' : ''}{entry.minutes} min</div>
                    </div>
                  ))
                )}
              </div>
            </div>

            {/* Task Submission Modal */}
            {showTaskModal && (
              <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'flex-end', justifyContent: 'center', zIndex: 100 }} onClick={() => { setShowTaskModal(false); setSelectedTask(null); setProofText(''); }}>
                <div style={{ backgroundColor: 'white', borderRadius: '24px 24px 0 0', padding: '24px', width: '100%', maxWidth: '600px', maxHeight: '85vh', overflowY: 'auto' }} onClick={e => e.stopPropagation()}>
                  {!selectedTask ? (
                    <>
                      <h2 style={{ margin: '0 0 20px', color: currentChild.color, textAlign: 'center' }}>What did you do? üåü</h2>
                      {Object.entries(TASKS).map(([category, tasks]) => (
                        <div key={category} style={{ marginBottom: '20px' }}>
                          <h3 style={{ margin: '0 0 12px', color: '#6B7280', fontSize: '13px', textTransform: 'uppercase' }}>
                            {category === 'chores' ? 'üßπ Chores' : category === 'homework' ? 'üìö Learning' : '‚≠ê Good Behavior'}
                          </h3>
                          <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                            {tasks.map(task => (
                              <button key={task.id} onClick={() => setSelectedTask(task)} style={{ padding: '10px 14px', backgroundColor: currentChild.bgColor, border: 'none', borderRadius: '10px', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '6px' }}>
                                <span>{task.emoji}</span>
                                <span style={{ fontWeight: '500', fontSize: '14px' }}>{task.name}</span>
                                <span style={{ backgroundColor: 'rgba(0,0,0,0.1)', padding: '2px 8px', borderRadius: '10px', fontSize: '12px', fontWeight: '600' }}>+{task.minutes}</span>
                              </button>
                            ))}
                          </div>
                        </div>
                      ))}
                    </>
                  ) : (
                    <>
                      <h2 style={{ margin: '0 0 8px', color: currentChild.color, textAlign: 'center' }}>{selectedTask.emoji} {selectedTask.name}</h2>
                      <p style={{ textAlign: 'center', color: '#6B7280', marginBottom: '20px' }}>Worth +{selectedTask.minutes} minutes!</p>

                      <div style={{ marginBottom: '20px' }}>
                        <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500', color: '#374151' }}>Tell your parents what you did:</label>
                        <textarea
                          value={proofText}
                          onChange={(e) => setProofText(e.target.value)}
                          placeholder="Example: I cleaned my whole room and organized my toys!"
                          style={{ width: '100%', padding: '14px', border: '2px solid #E5E7EB', borderRadius: '12px', fontSize: '16px', minHeight: '100px', resize: 'none', fontFamily: 'inherit' }}
                        />
                      </div>

                      <div style={{ display: 'flex', gap: '10px' }}>
                        <button onClick={() => { setSelectedTask(null); setProofText(''); }} style={{ flex: 1, padding: '14px', backgroundColor: '#F3F4F6', border: 'none', borderRadius: '12px', fontWeight: '600', color: '#6B7280', cursor: 'pointer' }}>Back</button>
                        <button onClick={submitTaskForApproval} disabled={!proofText.trim()} style={{ flex: 1, padding: '14px', backgroundColor: proofText.trim() ? currentChild.color : '#D1D5DB', border: 'none', borderRadius: '12px', fontWeight: '600', color: 'white', cursor: proofText.trim() ? 'pointer' : 'not-allowed' }}>Send to Parents! üì§</button>
                      </div>
                    </>
                  )}
                  <button onClick={() => { setShowTaskModal(false); setSelectedTask(null); setProofText(''); }} style={{ width: '100%', padding: '14px', backgroundColor: 'transparent', border: 'none', color: '#6B7280', cursor: 'pointer', marginTop: '12px' }}>Cancel</button>
                </div>
              </div>
            )}

            {/* Screen Time Request Modal */}
            {showRequestModal && (
              <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100 }} onClick={() => setShowRequestModal(false)}>
                <div style={{ backgroundColor: 'white', borderRadius: '20px', padding: '24px', width: '90%', maxWidth: '400px' }} onClick={e => e.stopPropagation()}>
                  <h2 style={{ margin: '0 0 8px', color: currentChild.color, textAlign: 'center' }}>üì± Request Screen Time</h2>
                  <p style={{ margin: '0 0 20px', color: '#6B7280', textAlign: 'center' }}>You have {formatTime(balances[userMode])} available</p>

                  <div style={{ marginBottom: '16px' }}>
                    <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>How many minutes?</label>
                    <div style={{ display: 'flex', gap: '8px' }}>
                      {[15, 30, 45, 60].map(mins => (
                        <button key={mins} onClick={() => setRequestMinutes(mins)} style={{ flex: 1, padding: '12px', backgroundColor: requestMinutes === mins ? currentChild.color : '#F3F4F6', color: requestMinutes === mins ? 'white' : '#374151', border: 'none', borderRadius: '8px', fontWeight: '600', cursor: 'pointer' }}>{mins}</button>
                      ))}
                    </div>
                  </div>

                  <div style={{ marginBottom: '20px' }}>
                    <label style={{ display: 'block', marginBottom: '8px', fontWeight: '500' }}>What for?</label>
                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                      {['iPad', 'TV', 'Video Games', 'Computer', 'Phone'].map(activity => (
                        <button key={activity} onClick={() => setRequestActivity(activity)} style={{ padding: '10px 16px', backgroundColor: requestActivity === activity ? currentChild.color : '#F3F4F6', color: requestActivity === activity ? 'white' : '#374151', border: 'none', borderRadius: '8px', fontWeight: '500', cursor: 'pointer' }}>{activity}</button>
                      ))}
                    </div>
                  </div>

                  <div style={{ display: 'flex', gap: '10px' }}>
                    <button onClick={() => setShowRequestModal(false)} style={{ flex: 1, padding: '14px', backgroundColor: '#F3F4F6', border: 'none', borderRadius: '12px', fontWeight: '600', color: '#6B7280', cursor: 'pointer' }}>Cancel</button>
                    <button onClick={submitScreenTimeRequest} disabled={!requestActivity || requestMinutes > balances[userMode]} style={{ flex: 1, padding: '14px', backgroundColor: (!requestActivity || requestMinutes > balances[userMode]) ? '#D1D5DB' : currentChild.color, border: 'none', borderRadius: '12px', fontWeight: '600', color: 'white', cursor: (!requestActivity || requestMinutes > balances[userMode]) ? 'not-allowed' : 'pointer' }}>Ask Parents üì§</button>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      }

      // Parent View
      return (
        <div style={{ minHeight: '100vh', backgroundColor: '#F0F9FF', fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif' }}>
          {/* Header */}
          <div style={{ background: 'linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%)', padding: '20px', color: 'white' }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', maxWidth: '600px', margin: '0 auto' }}>
              <div>
                <h1 style={{ margin: 0, fontSize: '24px' }}>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Parent Dashboard</h1>
                <p style={{ margin: '4px 0 0', opacity: 0.9, fontSize: '14px' }}>
                  {pendingSubmissions.length + pendingRequests.length > 0
                    ? `${pendingSubmissions.length + pendingRequests.length} items need approval`
                    : 'All caught up!'}
                </p>
              </div>
              <button onClick={handleLogout} style={{ padding: '8px 16px', backgroundColor: 'rgba(255,255,255,0.2)', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer', fontSize: '14px' }}>
                Switch User
              </button>
            </div>
          </div>

          {/* Tabs */}
          <div style={{ display: 'flex', backgroundColor: 'white', borderBottom: '2px solid #E5E7EB', position: 'sticky', top: 0, zIndex: 10 }}>
            {[
              { id: 'dashboard', label: 'üè† Overview' },
              { id: 'approvals', label: `‚úì Approvals ${(pendingSubmissions.length + pendingRequests.length) > 0 ? `(${pendingSubmissions.length + pendingRequests.length})` : ''}` },
              { id: 'history', label: 'üìú History' },
              { id: 'settings', label: '‚öôÔ∏è' }
            ].map(tab => (
              <button key={tab.id} onClick={() => setActiveTab(tab.id)} style={{ flex: 1, padding: '14px', border: 'none', backgroundColor: activeTab === tab.id ? '#EEF2FF' : 'white', color: activeTab === tab.id ? '#4F46E5' : '#6B7280', fontWeight: activeTab === tab.id ? '600' : '500', fontSize: '14px', cursor: 'pointer', borderBottom: activeTab === tab.id ? '3px solid #4F46E5' : '3px solid transparent' }}>{tab.label}</button>
            ))}
          </div>

          <div style={{ padding: '20px', maxWidth: '600px', margin: '0 auto' }}>
            {/* Overview Tab */}
            {activeTab === 'dashboard' && (
              <div>
                {CHILDREN.map(child => (
                  <div key={child.id} style={{ backgroundColor: 'white', borderRadius: '16px', padding: '20px', marginBottom: '16px', boxShadow: '0 2px 10px rgba(0,0,0,0.06)', border: `2px solid ${child.bgColor}` }}>
                    <div style={{ display: 'flex', alignItems: 'center', marginBottom: '16px' }}>
                      <div style={{ width: '50px', height: '50px', borderRadius: '50%', backgroundColor: child.bgColor, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '24px', marginRight: '14px' }}>{child.emoji}</div>
                      <div style={{ flex: 1 }}>
                        <h2 style={{ margin: 0, color: child.color, fontSize: '20px' }}>{child.name}</h2>
                        <p style={{ margin: '4px 0 0', color: '#6B7280', fontSize: '13px' }}>Available balance</p>
                      </div>
                      <div style={{ backgroundColor: child.bgColor, padding: '8px 16px', borderRadius: '20px', color: child.color, fontWeight: '700', fontSize: '18px' }}>{formatTime(balances[child.id])}</div>
                    </div>
                    <div style={{ height: '10px', backgroundColor: '#F3F4F6', borderRadius: '5px', overflow: 'hidden' }}>
                      <div style={{ height: '100%', width: `${Math.min((balances[child.id] / 120) * 100, 100)}%`, backgroundColor: child.color, borderRadius: '5px' }} />
                    </div>
                  </div>
                ))}

                {/* Quick Add Section */}
                <div style={{ backgroundColor: 'white', borderRadius: '16px', padding: '20px', boxShadow: '0 2px 10px rgba(0,0,0,0.06)' }}>
                  <h3 style={{ margin: '0 0 16px', color: '#374151' }}>‚ö° Quick Add Minutes</h3>
                  <p style={{ color: '#6B7280', fontSize: '14px', marginBottom: '16px' }}>Directly add minutes without waiting for submission</p>
                  {CHILDREN.map(child => (
                    <div key={child.id} style={{ marginBottom: '16px' }}>
                      <h4 style={{ margin: '0 0 8px', color: child.color, fontSize: '14px' }}>{child.name}</h4>
                      <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>
                        {[{ name: '+5 min', minutes: 5, emoji: '‚≠ê' }, { name: '+10 min', minutes: 10, emoji: 'üåü' }, { name: '+15 min', minutes: 15, emoji: '‚ú®' }, { name: '+30 min', minutes: 30, emoji: 'üéâ' }].map(bonus => (
                          <button key={bonus.minutes} onClick={() => quickAddMinutes(child.id, bonus)} style={{ padding: '8px 12px', backgroundColor: child.bgColor, color: child.color, border: 'none', borderRadius: '8px', fontSize: '13px', fontWeight: '600', cursor: 'pointer' }}>{bonus.emoji} {bonus.name}</button>
                        ))}
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}

            {/* Approvals Tab */}
            {activeTab === 'approvals' && (
              <div>
                <h2 style={{ margin: '0 0 16px', color: '#374151', fontSize: '18px' }}>Task Completions</h2>
                {pendingSubmissions.length === 0 ? (
                  <div style={{ backgroundColor: 'white', borderRadius: '16px', padding: '30px', textAlign: 'center', color: '#9CA3AF', marginBottom: '24px' }}>
                    <div style={{ fontSize: '40px', marginBottom: '8px' }}>‚úÖ</div>
                    <p>No pending task submissions</p>
                  </div>
                ) : (
                  pendingSubmissions.map(submission => {
                    const child = CHILDREN.find(c => c.id === submission.childId);
                    return (
                      <div key={submission.id} style={{ backgroundColor: 'white', borderRadius: '16px', padding: '16px', marginBottom: '12px', boxShadow: '0 2px 10px rgba(0,0,0,0.06)', border: `2px solid ${child.bgColor}` }}>
                        <div style={{ display: 'flex', alignItems: 'flex-start', marginBottom: '12px' }}>
                          <div style={{ width: '40px', height: '40px', borderRadius: '50%', backgroundColor: child.bgColor, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '20px', marginRight: '12px', flexShrink: 0 }}>{child.emoji}</div>
                          <div style={{ flex: 1 }}>
                            <div style={{ fontWeight: '600', color: '#374151' }}>{submission.childName}</div>
                            <div style={{ fontSize: '15px', color: child.color, fontWeight: '500' }}>{submission.taskEmoji} {submission.taskName} (+{submission.minutes} min)</div>
                          </div>
                        </div>
                        <div style={{ backgroundColor: '#F9FAFB', borderRadius: '10px', padding: '12px', marginBottom: '12px' }}>
                          <div style={{ fontSize: '12px', color: '#6B7280', marginBottom: '4px' }}>Their proof:</div>
                          <div style={{ fontSize: '14px', color: '#374151' }}>"{submission.proof}"</div>
                        </div>
                        <div style={{ display: 'flex', gap: '10px' }}>
                          <button onClick={() => handleTaskSubmission(submission.id, true)} style={{ flex: 1, padding: '12px', backgroundColor: '#10B981', color: 'white', border: 'none', borderRadius: '10px', fontWeight: '600', cursor: 'pointer' }}>‚úì Approve (+{submission.minutes})</button>
                          <button onClick={() => handleTaskSubmission(submission.id, false)} style={{ flex: 1, padding: '12px', backgroundColor: '#EF4444', color: 'white', border: 'none', borderRadius: '10px', fontWeight: '600', cursor: 'pointer' }}>‚úó Deny</button>
                        </div>
                      </div>
                    );
                  })
                )}

                <h2 style={{ margin: '24px 0 16px', color: '#374151', fontSize: '18px' }}>Screen Time Requests</h2>
                {pendingRequests.length === 0 ? (
                  <div style={{ backgroundColor: 'white', borderRadius: '16px', padding: '30px', textAlign: 'center', color: '#9CA3AF' }}>
                    <div style={{ fontSize: '40px', marginBottom: '8px' }}>üì±</div>
                    <p>No pending screen time requests</p>
                  </div>
                ) : (
                  pendingRequests.map(request => {
                    const child = CHILDREN.find(c => c.id === request.childId);
                    return (
                      <div key={request.id} style={{ backgroundColor: 'white', borderRadius: '16px', padding: '16px', marginBottom: '12px', boxShadow: '0 2px 10px rgba(0,0,0,0.06)', border: `2px solid ${child.bgColor}` }}>
                        <div style={{ display: 'flex', alignItems: 'center', marginBottom: '12px' }}>
                          <div style={{ width: '40px', height: '40px', borderRadius: '50%', backgroundColor: child.bgColor, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '20px', marginRight: '12px' }}>{child.emoji}</div>
                          <div style={{ flex: 1 }}>
                            <div style={{ fontWeight: '600', color: '#374151' }}>{request.childName}</div>
                            <div style={{ fontSize: '14px', color: '#6B7280' }}>wants {request.minutes} min for <strong>{request.activity}</strong></div>
                            <div style={{ fontSize: '12px', color: '#9CA3AF' }}>Balance: {formatTime(balances[request.childId])}</div>
                          </div>
                        </div>
                        <div style={{ display: 'flex', gap: '10px' }}>
                          <button onClick={() => handleScreenTimeRequest(request.id, true)} style={{ flex: 1, padding: '12px', backgroundColor: '#10B981', color: 'white', border: 'none', borderRadius: '10px', fontWeight: '600', cursor: 'pointer' }}>‚úì Approve</button>
                          <button onClick={() => handleScreenTimeRequest(request.id, false)} style={{ flex: 1, padding: '12px', backgroundColor: '#EF4444', color: 'white', border: 'none', borderRadius: '10px', fontWeight: '600', cursor: 'pointer' }}>‚úó Deny</button>
                        </div>
                      </div>
                    );
                  })
                )}
              </div>
            )}

            {/* History Tab */}
            {activeTab === 'history' && (
              <div>
                <h2 style={{ margin: '0 0 16px', color: '#374151', fontSize: '18px' }}>Activity History</h2>
                {history.length === 0 ? (
                  <div style={{ backgroundColor: 'white', borderRadius: '16px', padding: '40px', textAlign: 'center', color: '#9CA3AF' }}>
                    <div style={{ fontSize: '48px', marginBottom: '12px' }}>üìù</div>
                    <p>No activity yet</p>
                  </div>
                ) : (
                  history.slice(0, 50).map(entry => {
                    const child = CHILDREN.find(c => c.id === entry.childId);
                    return (
                      <div key={entry.id} style={{ backgroundColor: 'white', borderRadius: '12px', padding: '14px 16px', marginBottom: '8px', display: 'flex', alignItems: 'center', boxShadow: '0 1px 4px rgba(0,0,0,0.04)' }}>
                        <div style={{ width: '36px', height: '36px', borderRadius: '50%', backgroundColor: entry.type === 'earned' ? '#D1FAE5' : '#FEE2E2', display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '16px', marginRight: '12px' }}>{entry.emoji}</div>
                        <div style={{ flex: 1 }}>
                          <div style={{ fontWeight: '500', color: '#374151', fontSize: '14px' }}>{entry.description}</div>
                          <div style={{ fontSize: '12px', color: '#9CA3AF' }}>{child.emoji} {child.name} ‚Ä¢ {new Date(entry.timestamp).toLocaleString([], { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' })}</div>
                        </div>
                        <div style={{ fontWeight: '600', color: entry.type === 'earned' ? '#059669' : '#DC2626', fontSize: '14px' }}>{entry.type === 'earned' ? '+' : ''}{entry.minutes} min</div>
                      </div>
                    );
                  })
                )}
              </div>
            )}

            {/* Settings Tab */}
            {activeTab === 'settings' && (
              <div>
                <h2 style={{ margin: '0 0 16px', color: '#374151', fontSize: '18px' }}>Settings</h2>

                <div style={{ backgroundColor: 'white', borderRadius: '16px', padding: '20px', marginBottom: '16px', boxShadow: '0 2px 10px rgba(0,0,0,0.06)' }}>
                  <h3 style={{ margin: '0 0 12px', color: '#374151', fontSize: '16px' }}>üîê Parent PIN</h3>
                  <p style={{ color: '#6B7280', fontSize: '14px', marginBottom: '12px' }}>Change the PIN required for parent access</p>
                  <button onClick={() => setShowChangePinModal(true)} style={{ padding: '12px 20px', backgroundColor: '#4F46E5', color: 'white', border: 'none', borderRadius: '10px', fontWeight: '600', cursor: 'pointer' }}>Change PIN</button>
                </div>

                <div style={{ backgroundColor: 'white', borderRadius: '16px', padding: '20px', boxShadow: '0 2px 10px rgba(0,0,0,0.06)' }}>
                  <h3 style={{ margin: '0 0 12px', color: '#374151', fontSize: '16px' }}>üóëÔ∏è Reset Data</h3>
                  <p style={{ color: '#6B7280', fontSize: '14px', marginBottom: '12px' }}>Clear all balances, history, and pending items</p>
                  <button onClick={() => {
                    if (confirm('Are you sure? This will reset ALL data including balances and history.')) {
                      setBalances({ harper: 0, finley: 0 });
                      setHistory([]);
                      setTaskSubmissions([]);
                      setScreenTimeRequests([]);
                    }
                  }} style={{ padding: '12px 20px', backgroundColor: '#EF4444', color: 'white', border: 'none', borderRadius: '10px', fontWeight: '600', cursor: 'pointer' }}>Reset All Data</button>
                </div>
              </div>
            )}
          </div>

          {/* Change PIN Modal */}
          {showChangePinModal && (
            <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100 }} onClick={() => { setShowChangePinModal(false); setNewPin(''); }}>
              <div style={{ backgroundColor: 'white', borderRadius: '20px', padding: '24px', width: '90%', maxWidth: '320px' }} onClick={e => e.stopPropagation()}>
                <h2 style={{ margin: '0 0 16px', textAlign: 'center', color: '#374151' }}>üîê Change PIN</h2>
                <input
                  type="password"
                  inputMode="numeric"
                  pattern="[0-9]*"
                  maxLength={4}
                  placeholder="Enter new 4-digit PIN"
                  value={newPin}
                  onChange={(e) => setNewPin(e.target.value.replace(/\D/g, ''))}
                  style={{ width: '100%', padding: '14px', fontSize: '24px', textAlign: 'center', letterSpacing: '12px', border: '2px solid #E5E7EB', borderRadius: '12px', marginBottom: '16px' }}
                />
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => { setShowChangePinModal(false); setNewPin(''); }} style={{ flex: 1, padding: '14px', backgroundColor: '#F3F4F6', border: 'none', borderRadius: '12px', fontWeight: '600', color: '#6B7280', cursor: 'pointer' }}>Cancel</button>
                  <button onClick={handleChangePin} disabled={newPin.length !== 4} style={{ flex: 1, padding: '14px', backgroundColor: newPin.length === 4 ? '#4F46E5' : '#D1D5DB', border: 'none', borderRadius: '12px', fontWeight: '600', color: 'white', cursor: newPin.length === 4 ? 'pointer' : 'not-allowed' }}>Save</button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
